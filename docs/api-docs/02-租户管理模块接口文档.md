# 租户管理模块 - 后端API接口文档

## 基础信息
- **模块名称**: 租户管理
- **模块路径**: `/api/v1/tenants`
- **负责功能**: 租户的增删改查、统计

---

## 接口列表

### 1. 获取租户统计数据
**接口地址**: `GET /api/v1/tenants/stats`

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": {
    "totalTenants": 48,
    "enabledTenants": 42,
    "disabledTenants": 6,
    "totalUsers": 1234,
    "newTenantsThisMonth": 6,
    "growthRate": 14.0
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 2. 获取租户列表（分页）
**接口地址**: `GET /api/v1/tenants`

**查询参数**:
- `page`: 页码，默认1
- `size`: 每页大小，默认10
- `keyword`: 搜索关键词（名称、编码）
- `status`: 状态筛选（已启用、已禁用）
- `type`: 类型筛选（个人、企业）
- `accountType`: 账号类型（main、sub）

**请求示例**:
```
GET /api/v1/tenants?page=1&size=10&keyword=科技&status=已启用&type=企业
```

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": {
    "total": "48",
    "list": [
      {
        "tenantId": "1",
        "createdBy": "1000001",
        "creator": "系统管理员",
        "createdDate": "2024-01-15 10:00:00",
        "modifiedBy": "1000001",
        "modifier": "系统管理员",
        "modifiedDate": "2025-12-03 14:30:00",
        "id": "T001",
        "name": "聊办公集团",
        "code": "LIAOBG",
        "type": "企业",
        "accountType": "main",
        "adminName": "张三",
        "adminEmail": "zhangsan@liaobangong.com",
        "adminPhone": "138****1234",
        "userCount": 328,
        "departmentCount": 45,
        "status": "已启用",
        "address": "北京市朝阳区建国路88号",
        "expireDate": "2025-01-15",
        "logo": "https://logo.url/liaobg.png"
      }
    ]
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 3. 创建租户
**接口地址**: `POST /api/v1/tenants`

**请求参数**:
```json
{
  "name": "新租户名称",
  "code": "TENANT001",
  "type": "企业",
  "accountType": "sub",
  "adminName": "管理员姓名",
  "adminEmail": "admin@example.com",
  "adminPhone": "13800138000",
  "address": "公司地址详细信息",
  "expireDate": "2025-12-31",
  "status": "已启用",
  "logo": "https://logo.url/tenant.png"
}
```

**响应数据**:
```json
{
  "code": "S",
  "message": "创建成功",
  "data": {
    "tenantId": "1",
    "createdBy": "1000001",
    "creator": "系统管理员",
    "createdDate": "2025-12-19 10:30:00",
    "modifiedBy": "1000001",
    "modifier": "系统管理员",
    "modifiedDate": "2025-12-19 10:30:00",
    "id": "T100",
    "name": "新租户名称",
    "code": "TENANT001",
    "type": "企业",
    "accountType": "sub",
    "adminName": "管理员姓名",
    "adminEmail": "admin@example.com",
    "adminPhone": "13800138000",
    "userCount": 0,
    "departmentCount": 0,
    "status": "已启用",
    "address": "公司地址详细信息",
    "expireDate": "2025-12-31",
    "logo": "https://logo.url/tenant.png"
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 4. 获取租户详情
**接口地址**: `GET /api/v1/tenants/{id}`

**路径参数**:
- `id`: 租户ID

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": {
    "tenantId": "1",
    "createdBy": "1000001",
    "creator": "系统管理员",
    "createdDate": "2024-01-15 10:00:00",
    "modifiedBy": "1000001",
    "modifier": "系统管理员",
    "modifiedDate": "2025-12-03 14:30:00",
    "id": "T001",
    "name": "聊办公集团",
    "code": "LIAOBG",
    "type": "企业",
    "accountType": "main",
    "adminName": "张三",
    "adminEmail": "zhangsan@liaobangong.com",
    "adminPhone": "138****1234",
    "userCount": 328,
    "departmentCount": 45,
    "status": "已启用",
    "address": "北京市朝阳区建国路88号",
    "expireDate": "2025-01-15",
    "logo": "https://logo.url/liaobg.png",
    "config": {
      "maxUsers": 500,
      "maxStorage": "100GB",
      "features": ["LDAP", "SSO", "API"]
    },
    "usage": {
      "currentUsers": 328,
      "currentStorage": "45GB",
      "apiCallsThisMonth": 125000
    }
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 5. 更新租户信息
**接口地址**: `PUT /api/v1/tenants/{id}`

**路径参数**:
- `id`: 租户ID

**请求参数**:
```json
{
  "name": "更新后的租户名称",
  "type": "企业",
  "adminName": "新管理员",
  "adminEmail": "newadmin@example.com",
  "adminPhone": "13900139000",
  "address": "新地址",
  "expireDate": "2026-12-31",
  "status": "已启用",
  "logo": "https://logo.url/new-logo.png"
}
```

**响应数据**:
```json
{
  "code": "S",
  "message": "更新成功",
  "data": {
    "tenantId": "1",
    "createdBy": "1000001",
    "creator": "系统管理员",
    "createdDate": "2024-01-15 10:00:00",
    "modifiedBy": "1000001",
    "modifier": "系统管理员",
    "modifiedDate": "2025-12-19 11:00:00",
    "id": "T001",
    "name": "更新后的租户名称",
    "code": "LIAOBG",
    "type": "企业",
    "accountType": "main",
    "adminName": "新管理员",
    "adminEmail": "newadmin@example.com",
    "adminPhone": "13900139000",
    "userCount": 328,
    "departmentCount": 45,
    "status": "已启用",
    "address": "新地址",
    "expireDate": "2026-12-31",
    "logo": "https://logo.url/new-logo.png"
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 6. 删除租户
**接口地址**: `DELETE /api/v1/tenants/{id}`

**路径参数**:
- `id`: 租户ID

**响应**: HTTP 204 No Content（无响应体）

---

### 7. 启用/禁用租户
**接口地址**: `PATCH /api/v1/tenants/{id}/status`

**路径参数**:
- `id`: 租户ID

**请求参数**:
```json
{
  "status": "已禁用"
}
```

**响应数据**:
```json
{
  "code": "S",
  "message": "状态更新成功",
  "data": {
    "id": "T001",
    "status": "已禁用",
    "modifiedDate": "2025-12-19 11:00:00"
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 8. 获取租户配置
**接口地址**: `GET /api/v1/tenants/{id}/config`

**路径参数**:
- `id`: 租户ID

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": {
    "maxUsers": 500,
    "maxStorage": "100GB",
    "maxDepartments": 100,
    "features": ["LDAP", "SSO", "API", "AUDIT"],
    "customDomain": "liaobangong.com",
    "theme": {
      "primaryColor": "#1890ff",
      "logo": "https://logo.url/liaobg.png"
    }
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 9. 更新租户配置
**接口地址**: `PUT /api/v1/tenants/{id}/config`

**路径参数**:
- `id`: 租户ID

**请求参数**:
```json
{
  "maxUsers": 1000,
  "maxStorage": "200GB",
  "maxDepartments": 200,
  "features": ["LDAP", "SSO", "API", "AUDIT", "BACKUP"],
  "customDomain": "liaobangong.com"
}
```

**响应数据**:
```json
{
  "code": "S",
  "message": "配置更新成功",
  "data": {
    "maxUsers": 1000,
    "maxStorage": "200GB",
    "maxDepartments": 200,
    "features": ["LDAP", "SSO", "API", "AUDIT", "BACKUP"],
    "customDomain": "liaobangong.com",
    "modifiedDate": "2025-12-19 11:00:00"
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 10. 获取租户使用统计
**接口地址**: `GET /api/v1/tenants/{id}/usage`

**路径参数**:
- `id`: 租户ID

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": {
    "users": {
      "current": 328,
      "max": 500,
      "usage": 65.6
    },
    "storage": {
      "current": "45GB",
      "max": "100GB",
      "usage": 45.0
    },
    "departments": {
      "current": 45,
      "max": 100,
      "usage": 45.0
    },
    "apiCalls": {
      "thisMonth": 125000,
      "max": 1000000,
      "usage": 12.5
    }
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

## 错误码说明

| 错误码 | 说明 |
|--------|------|
| TENANT_001 | 租户编码已存在 |
| TENANT_002 | 租户不存在 |
| TENANT_003 | 主账号租户不能删除 |
| TENANT_004 | 租户下存在用户，无法删除 |
| TENANT_005 | 租户已过期 |
| TENANT_006 | 租户已达用户上限 |
| TENANT_007 | 租户存储空间已满 |
