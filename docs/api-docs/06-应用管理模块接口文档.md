# 应用管理模块 - 后端API接口文档

## 基础信息
- **模块名称**: 应用管理
- **模块路径**: `/api/v1/applications`
- **负责功能**: 应用的增删改查、菜单管理、标签管理

---

## 接口列表

### 1. 获取应用统计数据
**接口地址**: `GET /api/v1/applications/stats`

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": {
    "totalApplications": 24,
    "enabledApplications": 20,
    "disabledApplications": 4,
    "baseApplications": 8,
    "businessApplications": 12,
    "systemApplications": 4
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 2. 获取应用列表（分页）
**接口地址**: `GET /api/v1/applications`

**查询参数**:
- `page`: 页码，默认1
- `size`: 每页大小，默认10
- `keyword`: 搜索关键词（名称、编码）
- `type`: 类型筛选（基础应用、业务应用、系统应用）
- `status`: 状态筛选（启用、禁用）
- `source`: 来源筛选（installed、custom）
- `tags`: 标签筛选

**请求示例**:
```
GET /api/v1/applications?page=1&size=10&keyword=Angus&type=基础应用&status=启用
```

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": {
    "total": "24",
    "list": [
      {
        "tenantId": "1",
        "createdBy": "1000001",
        "creator": "柳小龙",
        "createdDate": "2024-01-02 11:22:39",
        "modifiedBy": "1000001",
        "modifier": "柳小龙",
        "modifiedDate": "2025-12-03 14:30:00",
        "id": "100002",
        "code": "AngusGM",
        "name": "AngusGM",
        "displayName": "AngusGM",
        "type": "基础应用",
        "version": "1.0.0",
        "versionType": "云服务版",
        "isDefault": true,
        "shopStatus": "注册成功",
        "sortOrder": 2,
        "status": "启用",
        "tags": ["DISPLAY_ON_NAVIGATOR", "CLOUD_SERVICE"],
        "url": "https://gm.xcan.cloud",
        "groupId": null,
        "tenantName": "联普云（北京）科技有限公司",
        "description": "云服务器主机管理",
        "isInstalled": true
      }
    ]
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 3. 创建应用
**接口地址**: `POST /api/v1/applications`

**请求参数**:
```json
{
  "code": "CustomApp",
  "name": "自定义应用",
  "displayName": "业务系统",
  "type": "业务应用",
  "version": "1.0.0",
  "versionType": "本地版",
  "url": "https://app.example.com",
  "tags": ["ENTERPRISE", "DISPLAY_ON_MENU"],
  "sortOrder": 10,
  "status": "启用",
  "description": "业务管理系统"
}
```

**响应数据**:
```json
{
  "code": "S",
  "message": "创建成功",
  "data": {
    "tenantId": "1",
    "createdBy": "1000001",
    "creator": "柳小龙",
    "createdDate": "2025-12-19 10:30:00",
    "modifiedBy": "1000001",
    "modifier": "柳小龙",
    "modifiedDate": "2025-12-19 10:30:00",
    "id": "100100",
    "code": "CustomApp",
    "name": "自定义应用",
    "displayName": "业务系统",
    "type": "业务应用",
    "version": "1.0.0",
    "versionType": "本地版",
    "isDefault": false,
    "shopStatus": "未注册",
    "sortOrder": 10,
    "status": "启用",
    "tags": ["ENTERPRISE", "DISPLAY_ON_MENU"],
    "url": "https://app.example.com",
    "description": "业务管理系统",
    "isInstalled": false
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 4. 获取应用详情
**接口地址**: `GET /api/v1/applications/{id}`

**路径参数**:
- `id`: 应用ID

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": {
    "tenantId": "1",
    "createdBy": "1000001",
    "creator": "柳小龙",
    "createdDate": "2024-01-02 11:22:39",
    "modifiedBy": "1000001",
    "modifier": "柳小龙",
    "modifiedDate": "2025-12-03 14:30:00",
    "id": "100002",
    "code": "AngusGM",
    "name": "AngusGM",
    "displayName": "AngusGM",
    "type": "基础应用",
    "version": "1.0.0",
    "versionType": "云服务版",
    "isDefault": true,
    "shopStatus": "注册成功",
    "sortOrder": 2,
    "status": "启用",
    "tags": ["DISPLAY_ON_NAVIGATOR", "CLOUD_SERVICE"],
    "url": "https://gm.xcan.cloud",
    "tenantName": "联普云（北京）科技有限公司",
    "description": "云服务器主机管理",
    "isInstalled": true,
    "menuCount": 15,
    "roleCount": 8,
    "userCount": 128
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 5. 更新应用信息
**接口地址**: `PUT /api/v1/applications/{id}`

**路径参数**:
- `id`: 应用ID

**请求参数**:
```json
{
  "name": "更新后的应用名",
  "displayName": "更新后的显示名",
  "type": "业务应用",
  "version": "1.1.0",
  "url": "https://new-url.example.com",
  "tags": ["ENTERPRISE", "DISPLAY_ON_MENU", "FIXED_POSITION"],
  "sortOrder": 5,
  "status": "启用",
  "description": "更新后的描述"
}
```

**响应数据**: 同创建应用（返回完整应用信息）

---

### 6. 删除应用
**接口地址**: `DELETE /api/v1/applications/{id}`

**路径参数**:
- `id`: 应用ID

**响应**: HTTP 204 No Content（无响应体）

---

### 7. 启用/禁用应用
**接口地址**: `PATCH /api/v1/applications/{id}/status`

**路径参数**:
- `id`: 应用ID

**请求参数**:
```json
{
  "status": "禁用"
}
```

**响应数据**:
```json
{
  "code": "S",
  "message": "状态更新成功",
  "data": {
    "id": "100002",
    "status": "禁用",
    "modifiedDate": "2025-12-19 11:00:00"
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 8. 获取应用菜单列表
**接口地址**: `GET /api/v1/applications/{id}/menus`

**路径参数**:
- `id`: 应用ID

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": [
    {
      "tenantId": "1",
      "createdBy": "1000001",
      "creator": "柳小龙",
      "createdDate": "2024-01-02 11:22:39",
      "modifiedBy": "1000001",
      "modifier": "柳小龙",
      "modifiedDate": "2025-12-03 14:30:00",
      "id": "M001",
      "appId": "100002",
      "name": "系统概览",
      "code": "dashboard",
      "icon": "LayoutDashboard",
      "path": "/dashboard",
      "parentId": null,
      "sortOrder": 1,
      "isVisible": true,
      "permission": "dashboard:view",
      "children": []
    },
    {
      "tenantId": "1",
      "createdBy": "1000001",
      "creator": "柳小龙",
      "createdDate": "2024-01-02 11:22:39",
      "modifiedBy": "1000001",
      "modifier": "柳小龙",
      "modifiedDate": "2025-12-03 14:30:00",
      "id": "M002",
      "appId": "100002",
      "name": "组织人员",
      "code": "organization",
      "icon": "Users",
      "path": "/organization",
      "parentId": null,
      "sortOrder": 2,
      "isVisible": true,
      "permission": "organization:view",
      "children": [
        {
          "id": "M002-1",
          "name": "用户",
          "code": "users",
          "path": "/users",
          "parentId": "M002",
          "sortOrder": 1
        }
      ]
    }
  ],
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 9. 创建应用菜单
**接口地址**: `POST /api/v1/applications/{id}/menus`

**路径参数**:
- `id`: 应用ID

**请求参数**:
```json
{
  "name": "新菜单",
  "code": "new-menu",
  "icon": "FileText",
  "path": "/new-menu",
  "parentId": null,
  "sortOrder": 10,
  "isVisible": true,
  "permission": "new-menu:view"
}
```

**响应数据**:
```json
{
  "code": "S",
  "message": "创建成功",
  "data": {
    "tenantId": "1",
    "createdBy": "1000001",
    "creator": "柳小龙",
    "createdDate": "2025-12-19 10:30:00",
    "modifiedBy": "1000001",
    "modifier": "柳小龙",
    "modifiedDate": "2025-12-19 10:30:00",
    "id": "M100",
    "appId": "100002",
    "name": "新菜单",
    "code": "new-menu",
    "icon": "FileText",
    "path": "/new-menu",
    "parentId": null,
    "sortOrder": 10,
    "isVisible": true,
    "permission": "new-menu:view"
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 10. 更新应用菜单
**接口地址**: `PUT /api/v1/applications/{id}/menus/{menuId}`

**路径参数**:
- `id`: 应用ID
- `menuId`: 菜单ID

**请求参数**:
```json
{
  "name": "更新后的菜单名",
  "icon": "FileEdit",
  "path": "/updated-menu",
  "sortOrder": 5,
  "isVisible": true
}
```

**响应数据**: 同创建菜单（返回完整菜单信息）

---

### 11. 删除应用菜单
**接口地址**: `DELETE /api/v1/applications/{id}/menus/{menuId}`

**路径参数**:
- `id`: 应用ID
- `menuId`: 菜单ID

**响应**: HTTP 204 No Content（无响应体）

---

### 12. 调整菜单排序
**接口地址**: `PATCH /api/v1/applications/{id}/menus/sort`

**路径参数**:
- `id`: 应用ID

**请求参数**:
```json
{
  "menuOrders": [
    {
      "id": "M001",
      "sortOrder": 2
    },
    {
      "id": "M002",
      "sortOrder": 1
    },
    {
      "id": "M003",
      "sortOrder": 3
    }
  ]
}
```

**响应数据**:
```json
{
  "code": "S",
  "message": "排序更新成功",
  "data": null,
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 13. 获取可用标签列表
**接口地址**: `GET /api/v1/applications/available-tags`

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": [
    {
      "id": "1",
      "name": "HEADER_MENU_POPOVER",
      "description": "头部菜单自定义下拉菜单"
    },
    {
      "id": "2",
      "name": "DYNAMIC_POSITION",
      "description": "标识动态位置显示功能"
    },
    {
      "id": "3",
      "name": "FIXED_POSITION",
      "description": "标识固定位置显示功能"
    },
    {
      "id": "4",
      "name": "CLOUD_SERVICE",
      "description": "标识云服务应用"
    },
    {
      "id": "5",
      "name": "ENTERPRISE",
      "description": "标识企业版应用"
    },
    {
      "id": "8",
      "name": "DISPLAY_ON_NAVIGATOR",
      "description": "控制在导航栏展示"
    },
    {
      "id": "9",
      "name": "DISPLAY_ON_MENU",
      "description": "控制在菜单栏展示"
    }
  ],
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

## 错误码说明

| 错误码 | 说明 |
|--------|------|
| APP_001 | 应用编码已存在 |
| APP_002 | 应用不存在 |
| APP_003 | 默认应用不能删除 |
| APP_004 | 已安装的应用不能删除 |
| APP_005 | 菜单编码已存在 |
| APP_006 | 菜单不存在 |
| APP_007 | 菜单下存在子菜单，无法删除 |
| APP_008 | 标签不存在 |
