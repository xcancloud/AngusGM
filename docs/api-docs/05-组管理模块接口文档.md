# 组管理模块 - 后端API接口文档

## 基础信息
- **模块名称**: 组管理
- **模块路径**: `/api/v1/groups`
- **负责功能**: 组的增删改查、成员管理

---

## 接口列表

### 1. 获取组统计数据
**接口地址**: `GET /api/v1/groups/stats`

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": {
    "totalGroups": 89,
    "projectGroups": 42,
    "functionGroups": 35,
    "tempGroups": 12,
    "activeMembers": 567,
    "newGroupsThisMonth": 12
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 2. 获取组列表（分页）
**接口地址**: `GET /api/v1/groups`

**查询参数**:
- `page`: 页码，默认1
- `size`: 每页大小，默认10
- `keyword`: 搜索关键词（名称、描述）
- `type`: 类型筛选（项目组、职能组、临时组）
- `status`: 状态筛选（活跃、归档）
- `ownerId`: 负责人ID筛选

**请求示例**:
```
GET /api/v1/groups?page=1&size=10&keyword=项目&type=项目组&status=活跃
```

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": {
    "total": "89",
    "list": [
      {
        "tenantId": "1",
        "createdBy": "1000001",
        "creator": "系统管理员",
        "createdDate": "2024-11-01 10:00:00",
        "modifiedBy": "1000001",
        "modifier": "系统管理员",
        "modifiedDate": "2025-12-18 16:30:00",
        "id": "G001",
        "name": "AngusGM项目组",
        "description": "负责AngusGM平台的开发和维护",
        "type": "项目组",
        "ownerName": "张三",
        "ownerId": "U001",
        "ownerAvatar": "https://avatar.url/zhangsan.png",
        "memberCount": 12,
        "status": "活跃",
        "tags": ["开发", "管理平台"],
        "lastActive": "2025-12-18 16:30:00"
      }
    ]
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 3. 创建组
**接口地址**: `POST /api/v1/groups`

**请求参数**:
```json
{
  "name": "新项目组",
  "description": "项目组描述信息",
  "type": "项目组",
  "ownerId": "U001",
  "memberIds": ["U002", "U003", "U004"],
  "tags": ["开发", "新项目"],
  "status": "活跃"
}
```

**响应数据**:
```json
{
  "code": "S",
  "message": "创建成功",
  "data": {
    "tenantId": "1",
    "createdBy": "1000001",
    "creator": "系统管理员",
    "createdDate": "2025-12-19 10:30:00",
    "modifiedBy": "1000001",
    "modifier": "系统管理员",
    "modifiedDate": "2025-12-19 10:30:00",
    "id": "G100",
    "name": "新项目组",
    "description": "项目组描述信息",
    "type": "项目组",
    "ownerName": "张三",
    "ownerId": "U001",
    "ownerAvatar": "https://avatar.url/zhangsan.png",
    "memberCount": 4,
    "status": "活跃",
    "tags": ["开发", "新项目"],
    "lastActive": "2025-12-19 10:30:00"
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 4. 获取组详情
**接口地址**: `GET /api/v1/groups/{id}`

**路径参数**:
- `id`: 组ID

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": {
    "tenantId": "1",
    "createdBy": "1000001",
    "creator": "系统管理员",
    "createdDate": "2024-11-01 10:00:00",
    "modifiedBy": "1000001",
    "modifier": "系统管理员",
    "modifiedDate": "2025-12-18 16:30:00",
    "id": "G001",
    "name": "AngusGM项目组",
    "description": "负责AngusGM平台的开发和维护",
    "type": "项目组",
    "ownerName": "张三",
    "ownerId": "U001",
    "ownerAvatar": "https://avatar.url/zhangsan.png",
    "memberCount": 12,
    "status": "活跃",
    "tags": ["开发", "管理平台"],
    "lastActive": "2025-12-18 16:30:00",
    "members": [
      {
        "id": "U001",
        "name": "张三",
        "email": "zhangsan@example.com",
        "avatar": "https://avatar.url/zhangsan.png",
        "department": "技术部",
        "role": "组长",
        "joinDate": "2024-11-01"
      },
      {
        "id": "U002",
        "name": "李四",
        "email": "lisi@example.com",
        "avatar": "https://avatar.url/lisi.png",
        "department": "技术部",
        "role": "成员",
        "joinDate": "2024-11-02"
      }
    ]
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 5. 更新组信息
**接口地址**: `PUT /api/v1/groups/{id}`

**路径参数**:
- `id`: 组ID

**请求参数**:
```json
{
  "name": "更新后的组名",
  "description": "更新后的描述",
  "type": "项目组",
  "ownerId": "U002",
  "tags": ["开发", "管理平台", "更新"],
  "status": "活跃"
}
```

**响应数据**: 同创建组（返回完整组信息）

---

### 6. 删除组
**接口地址**: `DELETE /api/v1/groups/{id}`

**路径参数**:
- `id`: 组ID

**响应**: HTTP 204 No Content（无响应体）

---

### 7. 归档/激活组
**接口地址**: `PATCH /api/v1/groups/{id}/status`

**路径参数**:
- `id`: 组ID

**请求参数**:
```json
{
  "status": "归档"
}
```

**响应数据**:
```json
{
  "code": "S",
  "message": "状态更新成功",
  "data": {
    "id": "G001",
    "status": "归档",
    "modifiedDate": "2025-12-19 11:00:00"
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 8. 获取组成员列表
**接口地址**: `GET /api/v1/groups/{id}/members`

**路径参数**:
- `id`: 组ID

**查询参数**:
- `page`: 页码，默认1
- `size`: 每页大小，默认10
- `keyword`: 搜索关键词

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": {
    "total": "12",
    "list": [
      {
        "tenantId": "1",
        "createdBy": "1000001",
        "creator": "系统管理员",
        "createdDate": "2024-11-01 10:00:00",
        "modifiedBy": "1000001",
        "modifier": "系统管理员",
        "modifiedDate": "2025-12-03 14:30:00",
        "id": "U001",
        "name": "张三",
        "email": "zhangsan@example.com",
        "avatar": "https://avatar.url/zhangsan.png",
        "department": "技术部",
        "departmentId": "D001",
        "role": "组长",
        "joinDate": "2024-11-01",
        "isOwner": true
      }
    ]
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 9. 添加组成员
**接口地址**: `POST /api/v1/groups/{id}/members`

**路径参数**:
- `id`: 组ID

**请求参数**:
```json
{
  "userIds": ["U010", "U011", "U012"]
}
```

**响应数据**:
```json
{
  "code": "S",
  "message": "添加成功",
  "data": {
    "groupId": "G001",
    "addedCount": 3,
    "addedUsers": [
      {
        "id": "U010",
        "name": "用户1"
      },
      {
        "id": "U011",
        "name": "用户2"
      },
      {
        "id": "U012",
        "name": "用户3"
      }
    ]
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 10. 移除组成员
**接口地址**: `DELETE /api/v1/groups/{id}/members/{userId}`

**路径参数**:
- `id`: 组ID
- `userId`: 用户ID

**响应**: HTTP 204 No Content（无响应体）

---

### 11. 批量移除组成员
**接口地址**: `DELETE /api/v1/groups/{id}/members`

**路径参数**:
- `id`: 组ID

**请求参数**:
```json
{
  "userIds": ["U010", "U011", "U012"]
}
```

**响应**: HTTP 204 No Content（无响应体）

---

### 12. 设置组负责人
**接口地址**: `PATCH /api/v1/groups/{id}/owner`

**路径参数**:
- `id`: 组ID

**请求参数**:
```json
{
  "ownerId": "U005"
}
```

**响应数据**:
```json
{
  "code": "S",
  "message": "负责人设置成功",
  "data": {
    "groupId": "G001",
    "ownerId": "U005",
    "ownerName": "王五",
    "modifiedDate": "2025-12-19 11:00:00"
  },
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

### 13. 获取用户所在的组列表
**接口地址**: `GET /api/v1/groups/user/{userId}`

**路径参数**:
- `userId`: 用户ID

**响应数据**:
```json
{
  "code": "S",
  "message": "成功",
  "data": [
    {
      "tenantId": "1",
      "createdBy": "1000001",
      "creator": "系统管理员",
      "createdDate": "2024-11-01 10:00:00",
      "modifiedBy": "1000001",
      "modifier": "系统管理员",
      "modifiedDate": "2025-12-18 16:30:00",
      "id": "G001",
      "name": "AngusGM项目组",
      "type": "项目组",
      "ownerName": "张三",
      "memberCount": 12,
      "status": "活跃",
      "role": "成员"
    }
  ],
  "timestamp": "1763958969885",
  "extensions": {}
}
```

---

## 错误码说明

| 错误码 | 说明 |
|--------|------|
| GROUP_001 | 组名已存在 |
| GROUP_002 | 组不存在 |
| GROUP_003 | 组负责人不存在 |
| GROUP_004 | 用户不在该组中 |
| GROUP_005 | 用户已在该组中 |
| GROUP_006 | 不能移除组负责人 |
| GROUP_007 | 归档的组不能添加成员 |
